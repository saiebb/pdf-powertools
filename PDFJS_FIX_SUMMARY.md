# ๐ง ููุฎุต ุฅุตูุงุญ ูุดููุฉ PDF.js

## ๐ฏ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ
ูุงู ุงูุชุทุจูู ูุฏุฎู ูู ุญููุฉ ูุง ููุงุฆูุฉ ูู ุฅุนุงุฏุฉ ุงูุชุญููู ุจุณุจุจ:
1. ูุดู ุชุญููู ููุชุจุฉ PDF.js ูู CDN
2. ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุชููุฆุฉ ุงููุณุชูุฑุฉ
3. ุนุฏู ูุฌูุฏ ุขููุฉ ูููุน ุฅุนุงุฏุฉ ุงูุชุญููู ุงููุชูุฑุฑุฉ

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. ุชุญุณูู `pdfJsService.ts`
- โ ุฅุถุงูุฉ ุขููุฉ ูููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ
- โ ุชุญุณูู ููุทู ุงูุชุญูู ูู ุชููุฑ ุงูููุชุจุฉ
- โ ุฅุถุงูุฉ ุชุชุจุน ุญุงูุฉ ุงูุชููุฆุฉ
- โ ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

```typescript
// ูุชุบูุฑุงุช ูุชุชุจุน ุงูุญุงูุฉ
let pdfJsLoadAttempted = false;
let pdfJsSetupCompleted = false;
let setupPromise: Promise<void> | null = null;
```

### 2. ุชุญุณูู `App.tsx`
- โ ููุน ุฅุนุงุฏุฉ ุงูุชููุฆุฉ ุงููุชูุฑุฑุฉ ุจุงุณุชุฎุฏุงู `useRef`
- โ ุชุบููุฑ dependency array ุฅูู `[]` ูุชุดุบูู ูุฑุฉ ูุงุญุฏุฉ ููุท
- โ ุงูุณูุงุญ ููุชุทุจูู ุจุงูุนูู ุญุชู ูู ูุดู ุชุญููู PDF.js
- โ ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ

```typescript
const initializationInProgress = useRef(false);

useEffect(() => {
  // ููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ
  if (initializationInProgress.current) return;
  if (areCoreServicesReady) return;
  
  // ... ููุทู ุงูุชููุฆุฉ
}, []); // ุชุดุบูู ูุฑุฉ ูุงุญุฏุฉ ููุท
```

### 3. ุฅุถุงูุฉ ุฃุฏูุงุช ุงูุชุดุฎูุต
- โ ุฅูุดุงุก `pdfJsChecker.ts` ููุชุญูู ูู ุญุงูุฉ PDF.js
- โ ุฅุถุงูุฉ ุฏูุงู ูุณุงุนุฏุฉ ููุชุดุฎูุต
- โ ุฅูุดุงุก ุตูุญุฉ ุชุดุฎูุต `debug-pdfjs.html`

### 4. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- โ ุนุฏู ุฅููุงู ุงูุชุทุจูู ุนูุฏ ูุดู ุชุญููู PDF.js
- โ ุนุฑุถ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู
- โ ุงูุณูุงุญ ุจุงูุนูู ุจูุธุงุฆู ูุญุฏูุฏุฉ

## ๐๏ธ ุงููููุงุช ุงูููุญุฏุซุฉ

### `lib/pdfJsService.ts`
```typescript
export function setupPdfJsWorker(): Promise<void> {
  // ููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ
  if (setupPromise) return setupPromise;
  if (pdfJsSetupCompleted && isPdfJsReady()) return Promise.resolve();
  
  // ููุทู ุงูุชุญููู ุงููุญุณู
  setupPromise = (async () => {
    // ... ููุทู ุงูุชุญููู ูุงูุชุญูู
  })();
  
  return setupPromise;
}
```

### `App.tsx`
```typescript
useEffect(() => {
  if (initializationInProgress.current) return;
  if (areCoreServicesReady) return;
  
  initializationInProgress.current = true;
  
  const initializeServices = async () => {
    try {
      // ... ููุทู ุงูุชููุฆุฉ
      setAreCoreServicesReady(true); // ุฏุงุฆูุงู true ูููุน ุฅุนุงุฏุฉ ุงูุชุญููู
    } finally {
      initializationInProgress.current = false;
    }
  };
  
  initializeServices();
}, []); // ุชุดุบูู ูุฑุฉ ูุงุญุฏุฉ ููุท
```

### `lib/pdfJsChecker.ts` (ุฌุฏูุฏ)
```typescript
export function checkPdfJsStatus(): PdfJsStatus {
  // ูุญุต ุดุงูู ูุญุงูุฉ PDF.js
}

export function isPdfJsReady(): boolean {
  // ุชุญูู ุณุฑูุน ูู ุฌุงูุฒูุฉ PDF.js
}
```

## ๐ ุฃุฏูุงุช ุงูุชุดุฎูุต

### 1. ุตูุญุฉ ุงูุชุดุฎูุต
ุงูุชุญ `debug-pdfjs.html` ูู ุงููุชุตูุญ ููุญุตูู ุนูู:
- โ ูุญุต ุดุงูู ูุญุงูุฉ PDF.js
- โ ูุนูููุงุช ููุตูุฉ ุนู ุงูุชุญููู
- โ ุณุฌู ููุตู ููุฃุญุฏุงุซ
- โ ุงุฎุชุจุงุฑ ุงูุชุญููู ุงูุชูุงุนูู

### 2. ุฏูุงู ุงูุชุดุฎูุต ูู ุงูููุฏ
```typescript
import { checkPdfJsStatus, isPdfJsReady, getPdfJsDebugInfo } from './lib/pdfJsChecker';

// ูุญุต ุงูุญุงูุฉ
const status = checkPdfJsStatus();
console.log(status);

// ูุญุต ุงูุฌุงูุฒูุฉ
if (isPdfJsReady()) {
  // PDF.js ุฌุงูุฒ ููุงุณุชุฎุฏุงู
}

// ูุนูููุงุช ุชุดุฎูุตูุฉ ููุตูุฉ
console.log(getPdfJsDebugInfo());
```

## ๐ฏ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### โ ูุง ุชู ุฅุตูุงุญู:
1. **ุฅููุงู ุญููุฉ ุฅุนุงุฏุฉ ุงูุชุญููู ุงููุง ููุงุฆูุฉ**
2. **ุชุญุณูู ุงุณุชูุฑุงุฑ ุงูุชุทุจูู**
3. **ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก**
4. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู**
5. **ุฃุฏูุงุช ุชุดุฎูุต ุดุงููุฉ**

### โ ุงูุณููู ุงูุฌุฏูุฏ:
1. **ุงูุชุทุจูู ูุญูู ูุฑุฉ ูุงุญุฏุฉ ููุท**
2. **ุฅุฐุง ูุดู ุชุญููู PDF.jsุ ุงูุชุทุจูู ูุณุชูุฑ ุจูุธุงุฆู ูุญุฏูุฏุฉ**
3. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุฏูุงู ูู ุฅุนุงุฏุฉ ุงูุชุญููู**
4. **ุฅููุงููุฉ ุชุดุฎูุต ุงููุดุงูู ุจุณูููุฉ**

## ๐ ุฎุทูุงุช ุงูุชุดุบูู

### 1. ุงุฎุชุจุงุฑ ุงูุชุทุจูู
```bash
# ุชุดุบูู ุงูุชุทุจูู
npm run dev
# ุฃู
yarn dev
```

### 2. ูู ุญุงูุฉ ุงุณุชูุฑุงุฑ ุงููุดููุฉ
1. ุงูุชุญ `debug-pdfjs.html` ูู ุงููุชุตูุญ
2. ุงุถุบุท "ูุญุต ุงูุญุงูุฉ" ู "ุงุฎุชุจุงุฑ ุงูุชุญููู"
3. ุฑุงุฌุน ุงูุณุฌูุงุช ูู console ุงููุชุตูุญ
4. ุชุญูู ูู Network tab ููุชุฃูุฏ ูู ุชุญููู ุงููููุงุช

### 3. ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ PDF.js (ุฅุฐุง ูุฒู ุงูุฃูุฑ)
```javascript
// ูู console ุงููุชุตูุญ
import { resetPdfJsSetup } from './lib/pdfJsService';
resetPdfJsSetup();
```

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:
1. **ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช**
2. **ุชุญูู ูู ุญุธุฑ ุงููุญุชูู ูู ุงููุชุตูุญ**
3. **ุงูุณุญ cache ุงููุชุตูุญ**
4. **ุชุญูู ูู console ููุฃุฎุทุงุก ุงูุฅุถุงููุฉ**
5. **ุงุณุชุฎุฏู ุตูุญุฉ ุงูุชุดุฎูุต ููุญุตูู ุนูู ูุนูููุงุช ููุตูุฉ**

### ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ:
- `PDF.js library not available` โ ูุดููุฉ ูู ุชุญููู ุงูููุชุจุฉ ูู CDN
- `Worker not configured` โ ูุดููุฉ ูู ุชุนููู ูุณุงุฑ Worker
- `Network error` โ ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ ุจุนุฏ ุชุทุจูู ูุฐู ุงูุญููู:
1. ุดุงุฑู ูุชุงุฆุฌ ุตูุญุฉ ุงูุชุดุฎูุต
2. ุดุงุฑู ุฑุณุงุฆู console
3. ุดุงุฑู ูุนูููุงุช ุงููุชุตูุญ ูุงููุธุงู

---

**โ ุชู ุฅุตูุงุญ ูุดููุฉ ุฅุนุงุฏุฉ ุงูุชุญููู ุงููุชูุฑุฑุฉ ุจูุฌุงุญ!**